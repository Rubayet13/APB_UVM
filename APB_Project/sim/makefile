###########################################################################
########################## Vivado Commands ################################
###########################################################################
###########################################################################


XVLOG				= /tools/Xilinx/Vivado/2023.2/bin/xvlog
XELAB				= /tools/Xilinx/Vivado/2023.2/bin/xelab
XSIM				= /tools/Xilinx/Vivado/2023.2/bin/xsim
PROJECT_HOME 		= /home/rubayet/Desktop/APB_Project

###########################################################################
########################## File Compilation ###############################
###########################################################################
###########################################################################
	
COMPILE_ORDER			= \
						$(PROJECT_HOME)/tb/tb_top/params.sv \
						$(PROJECT_HOME)/rtl/slave_rtl.sv \
						$(PROJECT_HOME)/rtl/apb_rtl.sv \
						$(PROJECT_HOME)/tb/tb_top/apb_interface.sv  \
						$(PROJECT_HOME)/tb/agent/agent_pkg.sv \
						$(PROJECT_HOME)/tb/environment/env_pkg.sv \
						$(PROJECT_HOME)/tb/sequence/seq_pkg.sv \
						$(PROJECT_HOME)/tb/test/test.sv \
						$(PROJECT_HOME)/tb/tb_top/apb_tb_top.sv \

###########################################################################
########################## Simulation Vars ################################
###########################################################################
###########################################################################

TB_TOP										= tb
COMP_OPT									= --incr --relax
SIM_LOG										= -log simulate.log
ELAB_LOG									= -log elaborate.log
XVLOG_LOG           						= -log xvlog.log
UVM 										= -L uvm		
UVM_VERBOSITY_CONTROL 						= UVM_MEDIUM
TEST_NAME									= test 
TIMESCALE									= -timescale 1ns/1ps

###########################################################################
########################### Make Targets ##################################
###########################################################################
###########################################################################

compilation	: 
			$(XVLOG) -sv $(COMPILE_ORDER) $(COMP_OPT) $(UVM)

elaboration	: compilation
			$(XELAB) $(TB_TOP) --relax -s top --debug typical 
	
simulate	: clean elaboration
			$(XSIM) top -testplusarg UVM_TESTNAME=$(TEST_NAME) -testplusarg UVM_VERBOSITY=$(UVM_VERBOSITY_CONTROL) -runall


###########################################################################
######################### WAVES ARE CHECKED FROM GTKWAVE ##################
######################### USING TB_TOP GENERATED DUMPFILE #################
###########################################################################

clean: 
	@echo "---------------------------------Running Clean--------------------------------" 
	@rm -rf *.jou *.log *.pb *.wdb xsim.dir xsim.covdb xcrg_report *.vcd 				# This deletes all files generated by Vivado
	@rm -rf .*.timestamp  										# This deletes all our timestamps

# .PHONY		: clean
# .PHONY		: wave